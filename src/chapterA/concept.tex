%! Suppress = MultipleIncludes
\documentclass[tikz,crop]{standalone}

\input{../tikz-preamble}

\begin{document}

\tikzstyle{process}=[node,rectangle]
\tikzstyle{terminator}=[node,rectangle,rounded corners=0.5cm]
\tikzstyle{io}=[node,trapezium,trapezium left angle=70,trapezium right angle=-70,minimum width=2.5cm,trapezium stretches=true]
\tikzstyle{inner}=[process,draw=gray]
\tikzstyle{arrow}=[draw, -latex]
\tikzstyle{small}=[font=\footnotesize,color=darkgray]
\tikzstyle{submission}=[document,align=right,minimum width=3cm,minimum height=1cm,text depth=0.5cm,inner sep=0.5mm,font=\scriptsize]

\begin{tikzpicture}
%    \draw[step=1.0,gray,thin] (0,0) grid (6,-16);

    \node[document,minimum width=3cm,minimum height=1cm] at (0, -0.8) (testplan) {Test suite};

    \node[submission,python] at (5, 0) (pysub) {Python};
    \node[submission,java] at (4.5, -0.4) (javasub) {Java};
    \node[submission,haskell] at (4, -0.8) (hssub) {Haskell};
    \node[submission,c] at (3.5, -1.2) (csub) {C};
    \node at (5, -1.7) (subm) {Submission};

    \node[process, minimum width=8cm, minimum height=4.5cm] at (0,-2.75) (tested) {};

    \draw[arrow] (csub) -- (tested.north-|csub);
    \draw[arrow] (testplan) -- (tested.north-|testplan);

    \node at (0.75, -3.125) (label) {\textsc{Test}ed};

    \node[inner, python, minimum width=7cm] at (0.5,-3.5) (core) {Core};
    \node[process, densely dotted, minimum width=7cm, minimum height=2.25cm] at (0.5,-4.5) (modules) {};
    \node[a,small] at (0.625, -4.625) (labelmod) {Programming language packages};
    \node[inner, java, minimum width=2cm] at (0.75,-5.25) (java) {Java};
    \node[inner, python, minimum width=2cm] at (3,-5.25) (python) {Python};

    \node[inner, haskell, minimum width=2cm] at (0.75,-6) (haskell) {Haskell};
    \node[inner, c, minimum width=2cm] at (3,-6) (c) {C};

    \node at (6.25,-5.625) (c) {\ldots};

    \node[document,minimum width=3cm,minimum height=1cm] at (2.5,-8) (feedback) {Feedback};

    \draw[arrow] (tested) -- (feedback);
\end{tikzpicture}

\end{document}
